<div class="register-container">
    <div class="card register-card">
        <div class="register-header">
            <h1>Регистрация</h1>
            <p class="register-subtitle">Email будет использоваться как логин для входа</p>
        </div>
        
        <% if (locals.errors && locals.errors.length > 0) { %>
            <div class="alert alert-error">
                <i class="fas fa-exclamation-circle"></i>
                <ul class="error-list">
                    <% locals.errors.forEach(error => { %>
                        <li><%= error %></li>
                    <% }); %>
                </ul>
            </div>
        <% } %>
        
        <% if (locals.success) { %>
            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i> <%= locals.success %>
            </div>
        <% } %>
        
        <form method="POST" action="/register" class="register-form" id="registerForm">
            <div class="form-group">
                <label for="name">Имя:</label>
                <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    value="<%= locals.name || '' %>"
                    required
                    minlength="2"
                    maxlength="100"
                    placeholder="Введите ваше имя (от 2 до 100 символов)"
                >
                <small class="form-hint">От 2 до 100 символов</small>
            </div>
            
            <div class="form-group">
                <label for="email">Email (будет логином):</label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    value="<%= locals.email || '' %>"
                    required
                    placeholder="example@mail.com"
                >
                <small class="form-hint">Этот email будет использоваться для входа в систему</small>
            </div>
            
            <div class="form-group">
                <label for="password">Пароль:</label>
                <div class="password-input-container">
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        required
                        minlength="8"
                        placeholder="Минимум 8 символов"
                    >
                </div>
                <small class="form-hint">Минимум 8 символов</small>
            </div>
            
            <div class="form-group">
                <label for="confirmPassword">Подтвердите пароль:</label>
                <div class="password-input-container">
                    <input 
                        type="password" 
                        id="confirmPassword" 
                        name="confirmPassword" 
                        required
                        minlength="8"
                        placeholder="Повторите пароль"
                    >
   
                </div>
            </div>
            
            
            
            <button type="submit" class="btn btn-primary register-btn" id="submitBtn">
                <span class="btn-text">Зарегистрироваться</span>
                <span class="btn-spinner" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i>
                </span>
            </button>
        </form>
        
        <div class="register-footer">
            <p>Уже есть аккаунт?</p>
            <a href="/login" class="login-link">Войти в систему</a>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
   
    setupPasswordToggle('password', 'togglePassword');
    setupPasswordToggle('confirmPassword', 'toggleConfirmPassword');
    
    // Валидация формы
    const form = document.getElementById('registerForm');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnSpinner = submitBtn.querySelector('.btn-spinner');
    
    form.addEventListener('submit', function(e) {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const terms = document.getElementById('terms').checked;
        
        if (password !== confirmPassword) {
            e.preventDefault();
            alert('Пароли не совпадают!');
            return false;
        }
        
       
        
        // Показываем индикатор загрузки
        btnText.style.display = 'none';
        btnSpinner.style.display = 'inline-block';
        submitBtn.disabled = true;
        
        return true;
    });
    
    // Динамическая проверка совпадения паролей
    const passwordInput = document.getElementById('password');
    const confirmInput = document.getElementById('confirmPassword');
    
    function checkPasswords() {
        if (passwordInput.value && confirmInput.value) {
            if (passwordInput.value !== confirmInput.value) {
                confirmInput.setCustomValidity('Пароли не совпадают');
            } else {
                confirmInput.setCustomValidity('');
            }
        }
    }
    
    passwordInput.addEventListener('input', checkPasswords);
    confirmInput.addEventListener('input', checkPasswords);
});
</script>